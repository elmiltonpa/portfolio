---
interface Props {
    id: string;
    title: string;
}

const { id, title } = Astro.props;
---

<dialog
    id={id}
    role="dialog"
    aria-labelledby="modal-title"
    aria-describedby="modal-content"
    class="fixed inset-0 z-100 w-full h-full bg-transparent p-0 backdrop:bg-background/80 backdrop:backdrop-blur-md"
>
    <div
        class="fixed inset-0 flex items-center justify-center p-4 md:p-6 modal-backdrop"
    >
        <div
            class="bg-card border border-border w-full max-w-3xl max-h-[90vh] rounded-3xl overflow-hidden shadow-2xl flex flex-col animate-fade-up"
        >
            <div
                class="flex items-center justify-between p-6 border-b border-border bg-secondary/30"
            >
                <h3
                    id="modal-title"
                    class="text-xl md:text-2xl font-bold text-foreground font-mono"
                >
                    <span class="text-primary">{"{"}</span>
                    {title}
                    <span class="text-primary">{"}"}</span>
                </h3>
                <button
                    data-close-modal
                    class="p-2 rounded-full hover:bg-white/10 text-muted-foreground hover:text-foreground transition-colors cursor-pointer"
                    aria-label="Cerrar modal"
                >
                    <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="24"
                        height="24"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        ><path d="M18 6 6 18"></path><path d="m6 6 12 12"
                        ></path></svg
                    >
                </button>
            </div>

            <div
                id="modal-content"
                class="p-6 md:p-8 overflow-y-auto custom-scrollbar"
            >
                <slot />
            </div>

            <div
                class="p-6 border-t border-border bg-secondary/10 flex justify-end"
            >
                <button
                    data-close-modal
                    class="px-6 py-2 rounded-xl bg-secondary text-foreground font-mono text-sm hover:bg-secondary/80 transition-colors border border-border cursor-pointer"
                >
                    Cerrar
                </button>
            </div>
        </div>
    </div>
</dialog>

<style>
    dialog::backdrop {
        animation: fade-in 0.3s ease-out forwards;
    }

    .custom-scrollbar::-webkit-scrollbar {
        width: 8px;
    }

    .custom-scrollbar::-webkit-scrollbar-track {
        background: transparent;
    }

    .custom-scrollbar::-webkit-scrollbar-thumb {
        background-color: var(--color-border);
        border-radius: 9999px;
    }

    .custom-scrollbar::-webkit-scrollbar-thumb:hover {
        background-color: var(--color-primary);
        opacity: 0.5;
    }
</style>

<script>
    document.addEventListener("astro:page-load", () => {
        const dialogs = document.querySelectorAll("dialog");

        dialogs.forEach((dialog) => {
            const closeButtons = dialog.querySelectorAll("[data-close-modal]");

            closeButtons.forEach((button) => {
                button.addEventListener("click", () => {
                    dialog.close();
                });
            });
            const backdrop = dialog.querySelector(".modal-backdrop");
            if (backdrop) {
                backdrop.addEventListener("click", (e) => {
                    if (e.target === backdrop) {
                        dialog.close();
                    }
                });
            }
            dialog.addEventListener("keydown", (e) => {
                if (e.key === "Escape") {
                    dialog.close();
                }
            });
        });
    });
</script>
